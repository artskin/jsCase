<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">
  <meta name="renderer" content="webkit">
  <title>手撸 - vue3 Reactivity</title>
  <meta name="description" content="首页描述"/>
  <meta name="keywords" content="首页关键词"/>
  <meta name="author" content="Web Layout:amu"/>
  <meta name="format-detection" content="telephone=no,date=no,address=no,email=no,url=no"/>
  <link rel="stylesheet" href="../src/style/base.css?v=1">
  <style>
    label{
      display: inline-block;
      width: 100px;
      text-align: right;
    }
  </style>
</head>
<body class="paper">
  <h3 class="center">vue3 - Reactivity</h3>
<hr>
  <p>
    <label for="price">price</label>
    <input type="number" name="price" id="input-price">
  </p>
  <p>
    <label for="discount">discount</label>
    <input type="number" name="discount" id="input-discount">
  </p>
<hr>
  <div class="result">

  </div>
<!-- <script src="../lib/vue@3.0.5.global.js"></script> -->
<script src="./reactivity.js"></script>
<script>
  let total = 0,
      baseData = { price:5,discount:2}

  //添加响应功能
  let product = reactive(baseData)
  let salePrice = ref(0)

  effect(() => {
    salePrice.value = product.price * 9
  })

  effect(() => {
    total = salePrice.value * product.discount
    total = total/10
    render()
  })

  function render(){
    $_('#input-price').value = product.price
    $_('#input-discount').value = product.discount
    $_('.result').innerHTML = `product:${JSON.stringify(product)} <br><br>(${product.price}*0.9)*${product.discount} = ${total}`
  }
  $_.all('input').forEach((item)=>{
    item.addEventListener('change',updateValue)
  })
  
  function updateValue(e){
    product[e.target.name] = e.target.value
  }
</script>
</body>
</html>